<ion-app>
  <!-- Error Message -->
  <div *ngIf="hasError" class="error-panel" style="
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(197, 0, 15, 0.9);
    color: white;
    padding: 30px;
    border-radius: 12px;
    z-index: 2000;
    max-width: 500px;
    text-align: center;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  ">
    <h2 style="margin: 0 0 15px 0; color: #fff;">‚ö†Ô∏è Map Service Error</h2>
    <p style="margin: 0 0 20px 0; line-height: 1.5;">{{ errorMessage }}</p>
    <div style="font-size: 14px; color: #ffcccc; line-height: 1.4;">
      <strong>Possible solutions:</strong><br>
      ‚Ä¢ Check if the server is running<br>
      ‚Ä¢ Verify network connectivity<br>
      ‚Ä¢ Check if the API endpoint is accessible<br>
      ‚Ä¢ Refresh the page to retry
    </div>
    <button 
      (click)="retryConnection()" 
      style="
        margin-top: 20px;
        padding: 10px 20px;
        background: #fff;
        color: #c5000f;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        font-weight: bold;
      ">
      Retry Connection
    </button>
  </div>

  <!-- Map Container -->
  <div id="map" [style.display]="hasError ? 'none' : 'block'"></div>
  
  <!-- Robot Status Panel -->
  <div *ngIf="!hasError" class="robot-status-panel" style="
    position: absolute;
    top: 20px;
    left: 20px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 15px;
    border-radius: 8px;
    z-index: 1000;
    min-width: 280px;
    font-family: 'Courier New', monospace;
    font-size: 14px;
  ">
    <h4 style="margin: 0 0 10px 0; color: #4CAF50;">Robot Status</h4>
    <div style="margin-bottom: 5px;">
      <strong>Position:</strong> 
      <span id="robot-position">{{ getRobotPositionText() }}</span>
    </div>
    <div style="margin-bottom: 5px;">
      <strong>Rotation:</strong> 
      <span id="robot-rotation">{{ getRobotRotationText() }}</span>
    </div>
    <div style="margin-bottom: 8px;">
      <strong>Localization:</strong> 
      <span [style.color]="getLocalizationConfidenceColor()">{{ getLocalizationStatusText() }}</span>
    </div>
    <div style="margin-bottom: 5px; color: #aaa;">
      <strong>Map:</strong> {{ getMapNameText() }}
    </div>
    <div style="margin-bottom: 5px; color: #aaa;">
      <strong>Map Size:</strong> {{ getMapDimensionsText() }}
    </div>
    <div style="margin-bottom: 5px; color: #aaa;">
      <strong>Resolution:</strong> {{ getResolutionText() }}
    </div>
    <div style="margin-bottom: 10px; color: #aaa;">
      <strong>Origin (ROS):</strong> {{ getOriginText() }}
    </div>
    <div style="margin-bottom: 10px; color: #aaa;">
      {{ getZoomLevelText() }}
    </div>
    <div style="font-size: 12px; color: #aaa; line-height: 1.4; margin-bottom: 10px;">
      üí° <strong>Controls:</strong><br>
      ‚Ä¢ Drag robot to move<br>
      ‚Ä¢ Drag green handle to rotate<br>
      ‚Ä¢ Double-click robot for +45¬∞ rotation<br>
      ‚Ä¢ All coordinates shown in meters
    </div>
    
    <!-- Localization Control -->
    <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #555;">
      <button 
        (click)="initializeLocalization()" 
        style="
          width: 100%;
          padding: 8px 12px;
          background: #4CAF50;
          color: white;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-weight: bold;
          font-size: 12px;
        "
        onmouseover="this.style.background='#45a049'"
        onmouseout="this.style.background='#4CAF50'"
      >
        Initialize Localization
      </button>
      <div style="font-size: 10px; color: #aaa; margin-top: 5px; text-align: center;">
        Send current robot position to AMR
      </div>
    </div>
  </div>
  
  <!-- <ion-router-outlet></ion-router-outlet> -->
</ion-app>
